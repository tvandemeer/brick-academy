import{getKlanten,getMandjes}from"./storageItems.js";import{confirmDeleteKlant,confirmDeleteMandje,showToast}from"./notify.js";import{updateNavbar}from"./navbar.js";const Swal=window["Swal"];function deleteKlant(e){e=e.target.dataset.klant;confirmDeleteKlant(e,"Weet je het zeker?","De actie kan niet ongedaan gemaakt worden","warning")}function deleteMandje(e){e=e.target.dataset.klant;getMandjes()[e]?console.log("Verwijder mandje van "+e):console.log("Klant heeft geen mandje")}function deleteArtikel(e){var t=e.target.dataset["klant"],e=parseInt(e.target.dataset.index),n=getMandjes(),a=n[t],l=a.artikelen.splice(e,1);if(l[0]){n[t]=a,localStorage.setItem("mandjes",JSON.stringify(n)),document.querySelector(`tr[data-row="${e}"`).remove();var d=document.querySelectorAll("#results-table-body tr"),r=document.querySelectorAll("#results-table-body button");for(let e=0;e<a.artikelen.length;e++)d[e].setAttribute("data-row",e),r[e].setAttribute("data-index",e);updateNavbar(),showToast("Verwijderd",l[0].naam,"success")}else console.log("Er ging iets mis, maar weet nog niet wat")}function populateResults(e){var t=getMandjes(),n=document.getElementById("results-table-body"),a=document.querySelectorAll("#results-table-body tr"),l=(a.length&&a.forEach(e=>{e.remove()}),e.target.value);if("selecteer klant ..."!=l){if(t[l]&&t[l].artikelen.length){var d=t[l]["artikelen"];for(let e=0;e<d.length;e++){var r=document.createElement("tr"),o=(r.setAttribute("data-row",e),document.createElement("td")),i=document.createElement("td"),c=document.createElement("td"),s=document.createElement("td"),m=document.createElement("button");s.classList.add("uk-text-right"),m.classList.add("uk-button"),m.classList.add("uk-button-danger"),m.classList.add("uk-button-small"),m.type="button",m.setAttribute("data-index",e),m.setAttribute("data-klant",l),m.innerText="X",m.addEventListener("click",deleteArtikel),o.innerText=d[e].id,i.innerText=d[e].naam,c.innerText=d[e].prijs,s.appendChild(m),r.appendChild(o),r.appendChild(i),r.appendChild(c),r.appendChild(s),n.appendChild(r)}}else{var a=document.createElement("tr"),e=document.createElement("td"),t=document.createElement("td"),u=document.createElement("td");e.innerText="---",t.innerText="Geen artikelen in mandje",u.innerText="---",a.appendChild(e),a.appendChild(t),a.appendChild(u),n.appendChild(a)}document.getElementById("delete-klant-btn").setAttribute("data-klant",l),document.getElementById("delete-mandje-btn").setAttribute("data-klant",l)}else console.log("geen klant geselecteerd")}function populateSelect(){var e=document.getElementById("select-element"),t=(document.querySelectorAll("#select-element option").forEach(e=>{e.remove()}),document.querySelectorAll("#results-table-body tr")),n=(t.length&&t.forEach(e=>{e.remove()}),getKlanten()),t=document.createElement("option");e.appendChild(t),t.innerText="selecteer klant ...";for(const l in n){var a=document.createElement("option");a.innerText=n[l].naam,e.appendChild(a)}e.addEventListener("change",populateResults),document.getElementById("delete-klant-btn").addEventListener("click",deleteKlant),document.getElementById("delete-mandje-btn").addEventListener("click",deleteMandje)}export{populateSelect};